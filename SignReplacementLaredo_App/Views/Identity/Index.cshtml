@using SignReplacementLaredo_App.Models
@using Microsoft.AspNetCore.Identity;
@model IQueryable<ApplicationUser>
@inject UserManager<ApplicationUser> _userManager
@inject RoleManager<IdentityRole> _roleManager

<h1>Registered Users</h1>
<br />

@if(Model.Any())
{
    <table class="table table-striped">
        <tbody>
            @foreach (ApplicationUser user in Model)
            {
                if (user.Email != "superadmin@superadmin.com")
                { 
                    <tr>
                        <td class="col-10 col-sm-10 col-md-10 col-lg-10 col-xl-10">@user.Email</td>

                        <td class="col-1 col-sm-1 col-md-1 col-lg-1 col-xl-1">
                            <a asp-action="EditUser" asp-controller="Identity" asp-route-id="@user.Id" class="btn btn-primary">Edit</a>
                        </td>

                        <td class="col-1 col-sm-1 col-md-1 col-lg-1 col-xl-1">
                            <a asp-action="DeleteUser" asp-controller="Identity" asp-route-id="@user.Id" class="btn btn-danger">Delete</a>
                        </td>
                    </tr>
                }
            }
        </tbody>
    </table>
}
else
{
    <div class="card text-light mb-3" style="max-width: 80%;">
        <div class="card-header bg-danger text-light"><h3>No users</h3></div>
        <div class="card-body bg-light text-danger">
            <h5 class="card-title">No registered users</h5>
            <p class="card-text">Proceed to register a user 
                <a asp-action="Register" asp-controller="Identity" class="text-danger fw-bold">here</a>
            </p>
        </div>
    </div>
}






@*
@if(Model.Any())
{
    <table class="table table-striped">
        <tbody>
            @foreach (IdentityUser user in Model)
            {
                <tr>
                    <td class="col-10 col-sm-10 col-md-10 col-lg-10 col-xl-10">@user.Email</td>

                    <td class="col-1 col-sm-1 col-md-1 col-lg-1 col-xl-1">
                        @if (user.UserName == "superadmin@superadmin.com")
                        {
                            <a asp-action="EditUser" asp-controller="Account" asp-route-id="@user.Id" class="btn btn-primary">Editar</a>
                        }
                        else
                        {
                            <a asp-action="EditUser" asp-controller="Account" asp-route-id="@user.Id" class="btn btn-primary">Editar</a>
                        }

                    </td>

                    <td class="col-1 col-sm-1 col-md-1 col-lg-1 col-xl-1">
                        @if (user.UserName == "superadmin@superadmin.com")
                        {
                            <a asp-action="DeleteUser" asp-controller="Account" asp-route-id="@user.Id" class="btn btn-danger disabled">Borrar</a>
                        }
                        else
                        {
                            <a asp-action="DeleteUser" asp-controller="Account" asp-route-id="@user.Id" class="btn btn-danger">Borrar</a>
                        }

                    </td>
                </tr>
            }
        </tbody>
    </table>
}
else
{
    <div class="card text-light mb-3" style="max-width: 80%;">
        <div class="card-header bg-danger text-light"><h3>Sin usuarios</h3></div>
        <div class="card-body bg-light text-danger">
            <h5 class="card-title">No hay usuarios registrados</h5>
            <p class="card-text">Proceda a registrar un usuario 
                <a asp-action="Register" asp-controller="Account" class="text-danger fw-bold">aquí</a>
            </p>
        </div>
    </div>
}
*@



@*
@{
    var currentUser = await _userManager.FindByNameAsync(User.Identity.Name);
    bool isSuperAdmin = await _userManager.IsInRoleAsync(currentUser, "SUPERADMIN") ? true : false;
}

@if(Model.Any())
{
    <table class="table table-striped">
        <tbody>
            @foreach (IdentityUser user in Model)
            {
                <tr>
                    <td class="col-10 col-sm-10 col-md-10 col-lg-10 col-xl-10">@user.Email</td>

                    <td class="col-1 col-sm-1 col-md-1 col-lg-1 col-xl-1">
                        @if (isSuperAdmin)
                        {
                            <a asp-action="EditUser" asp-controller="Account" asp-route-id="@user.Id" class="btn btn-primary">Editar</a>
                        }
                        else
                        {
                            <a asp-action="EditUser" asp-controller="Account" asp-route-id="@user.Id" class="btn btn-primary disabled">Editar</a>
                        }

                    </td>

                    <td class="col-1 col-sm-1 col-md-1 col-lg-1 col-xl-1">
                        @if (isSuperAdmin)
                        {
                            <a asp-action="DeleteUser" asp-controller="Account" asp-route-id="@user.Id" class="btn btn-danger">Borrar</a>
                        }
                        else
                        {
                            <a asp-action="DeleteUser" asp-controller="Account" asp-route-id="@user.Id" class="btn btn-danger disabled">Borrar</a>
                        }

                    </td>
                </tr>
            }
        </tbody>
    </table>
}
else
{
    <div class="card text-light mb-3" style="max-width: 80%;">
        <div class="card-header bg-danger text-light"><h3>Sin usuarios</h3></div>
        <div class="card-body bg-light text-danger">
            <h5 class="card-title">No hay usuarios registrados</h5>
            <p class="card-text">Proceda a registrar un usuario 
                <a asp-action="Register" asp-controller="Account" class="text-danger fw-bold">aquí</a>
            </p>
        </div>
    </div>
}*@






